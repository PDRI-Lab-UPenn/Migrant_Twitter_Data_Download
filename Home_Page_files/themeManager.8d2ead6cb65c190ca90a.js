(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{333:function(e,t,r){"use strict";r.r(t),r.d(t,"ThemeManager",(function(){return l}));r(9),r(8),r(20),r(11),r(12),r(30);var n=r(5),a=r(286),s=r(99),i=r(17);function u(e,t,r,n,a,s,i){try{var u=e[s](i),o=u.value}catch(e){return void r(e)}u.done?t(o):Promise.resolve(o).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var s=e.apply(t,r);function i(e){u(s,n,a,i,o,"next",e)}function o(e){u(s,n,a,i,o,"throw",e)}i(void 0)}))}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=function(){function e(t){var r,n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"KEY_VALUE_STORE_NAMESPACE","ThemeManager"),h(this,"KEY_VALUE_THEME_KEY","selectedTheme"),h(this,"currentTheme",void 0),h(this,"styleContainer",void 0),h(this,"keyValueStoreManager",void 0),h(this,"keyValueStore",new s.a({generator:(r=o(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=n.keyValueStoreManager)?void 0:t.get();case 2:return r=e.sent,e.abrupt("return",null==r?void 0:r.getKeyValueStore({namespace:n.KEY_VALUE_STORE_NAMESPACE}));case 4:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})})),this.keyValueStoreManager=t.keyValueStoreManager,this.styleContainer=document.querySelector('style[data-manager="theme-manager"]'),this.styleContainer||(this.styleContainer=document.createElement("style"),this.styleContainer.dataset.manager="theme-manager",document.head.appendChild(this.styleContainer))}var t,u,l,m,p,d,f,v,k,g;return t=e,(u=[{key:"startup",value:(g=o(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPersistedTheme();case 2:return t=e.sent,r=null!=t?t:a.a.light,this.setupAutoThemeListener(),e.next=7,this.setTheme(r,!1);case 7:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"setTheme",value:(k=o(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.currentTheme=t,e.t0=t,e.next=e.t0===a.a.light?4:e.t0===a.a.dark?8:e.t0===a.a.auto?12:24;break;case 4:return e.next=6,this.loadLightTheme();case 6:return n=e.sent,e.abrupt("break",24);case 8:return e.next=10,this.loadDarkTheme();case 10:return n=e.sent,e.abrupt("break",24);case 12:if(!window.matchMedia("(prefers-color-scheme: dark)").matches){e.next=19;break}return e.next=16,this.loadDarkTheme();case 16:e.t1=e.sent,e.next=22;break;case 19:return e.next=21,this.loadLightTheme();case 21:e.t1=e.sent;case 22:return n=e.t1,e.abrupt("break",24);case 24:this.activateTheme(n),r&&this.persistThemeSelection(t);case 26:case"end":return e.stop()}}),e,this)}))),function(e,t){return k.apply(this,arguments)})},{key:"activateTheme",value:function(e){Object(n.e)(e.asCssVariables,this.styleContainer)}},{key:"setupAutoThemeListener",value:function(){var e=this,t=window.matchMedia("(prefers-color-scheme: dark)");try{t.addEventListener("change",(function(t){e.darkModeCallback(t)}))}catch(r){try{t.addListener((function(t){e.darkModeCallback(t)}))}catch(e){console.error(e)}}}},{key:"darkModeCallback",value:(v=o(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentTheme===a.a.auto){e.next=2;break}return e.abrupt("return");case 2:if(!t.matches){e.next=8;break}return e.next=5,this.loadDarkTheme();case 5:r=e.sent,e.next=11;break;case 8:return e.next=10,this.loadLightTheme();case 10:r=e.sent;case 11:this.activateTheme(r);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"loadLightTheme",value:(f=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.a)((function(){return Promise.all([r.e(0),r.e(42)]).then(r.bind(null,348))}));case 2:return e.abrupt("return",e.sent.theme);case 3:case"end":return e.stop()}}),e)}))),function(){return f.apply(this,arguments)})},{key:"loadDarkTheme",value:(d=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.a)((function(){return Promise.all([r.e(0),r.e(41)]).then(r.bind(null,349))}));case 2:return e.abrupt("return",e.sent.theme);case 3:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)})},{key:"getPersistedTheme",value:(p=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.keyValueStore.get();case 2:return t=e.sent,e.prev=3,e.abrupt("return",null==t?void 0:t.get(this.KEY_VALUE_THEME_KEY));case 7:e.prev=7,e.t0=e.catch(3),console.error("Error getting persisted theme",e.t0);case 10:return e.abrupt("return",void 0);case 11:case"end":return e.stop()}}),e,this,[[3,7]])}))),function(){return p.apply(this,arguments)})},{key:"persistThemeSelection",value:(m=o(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=this.keyValueStore)?void 0:r.get();case 2:return n=e.sent,e.prev=3,e.next=6,null==n?void 0:n.set(this.KEY_VALUE_THEME_KEY,t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.error("Error persisting theme",e.t0);case 11:case"end":return e.stop()}}),e,this,[[3,8]])}))),function(e){return m.apply(this,arguments)})}])&&c(t.prototype,u),l&&c(t,l),e}()}}]);
//# sourceMappingURL=themeManager.8d2ead6cb65c190ca90a.js.map